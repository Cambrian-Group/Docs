"use strict";(self.webpackChunkcelo_docs=self.webpackChunkcelo_docs||[]).push([[7218],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return u}});var o=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=o.createContext({}),s=function(e){var t=o.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=s(e.components);return o.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,c=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),m=s(n),u=a,h=m["".concat(c,".").concat(u)]||m[u]||p[u]||r;return n?o.createElement(h,l(l({ref:t},d),{},{components:n})):o.createElement(h,l({ref:t},d))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,l=new Array(r);l[0]=m;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:a,l[1]=i;for(var s=2;s<r;s++)l[s]=n[s];return o.createElement.apply(null,l)}return o.createElement.apply(null,n)}m.displayName="MDXCreateElement"},14805:function(e,t,n){n.d(t,{Z:function(){return s}});var o=n(67294),a="pageRef_Ejpu",r="left_uwxi",l="arrow_+Oog",i="pageName_Jzs5",c="url_tyFG";function s(e){var t=e.url,n=e.pageName;return o.createElement("a",{className:a,href:t},o.createElement("div",{className:r},o.createElement("div",{className:l},"\u2192"),o.createElement("div",{className:i},n)),o.createElement("div",{className:c},t))}},33375:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return c},contentTitle:function(){return s},metadata:function(){return d},toc:function(){return p},default:function(){return u}});var o=n(83117),a=n(80102),r=(n(67294),n(3905)),l=n(14805),i=["components"],c={title:"Deploy and Interact with Contracts (Remotely)",description:"How to deploy and interact your own smart contracts using a remote node.",slug:"/developer-guide/start/hello-contract-remote-node"},s="Hello Contract (Truffle + Remote Node)",d={unversionedId:"developer-resources/walkthroughs/hello-contract-remote-node",id:"developer-resources/walkthroughs/hello-contract-remote-node",title:"Deploy and Interact with Contracts (Remotely)",description:"How to deploy and interact your own smart contracts using a remote node.",source:"@site/docs/developer-resources/walkthroughs/hello-contract-remote-node.md",sourceDirName:"developer-resources/walkthroughs",slug:"/developer-guide/start/hello-contract-remote-node",permalink:"/developer-guide/start/hello-contract-remote-node",editUrl:"https://github.com/celo-org/docs/edit/main/docs/developer-resources/walkthroughs/hello-contract-remote-node.md",tags:[],version:"current",frontMatter:{title:"Deploy and Interact with Contracts (Remotely)",description:"How to deploy and interact your own smart contracts using a remote node.",slug:"/developer-guide/start/hello-contract-remote-node"}},p=[{value:"Setup",id:"setup",children:[],level:2},{value:"Hello World!",id:"hello-world",children:[],level:2},{value:"Prepare Deployment",id:"prepare-deployment",children:[{value:"Compile the contract",id:"compile-the-contract",children:[],level:3}],level:2},{value:"Deploy to Alfajores (Remotely)",id:"deploy-to-alfajores-remotely",children:[{value:"Deploy the contract",id:"deploy-the-contract",children:[{value:"Truffle Deployment",id:"truffle-deployment",children:[],level:4},{value:"Custom Node.js Deployment",id:"custom-nodejs-deployment",children:[],level:4}],level:3},{value:"Interacting with Custom Contracts",id:"interacting-with-custom-contracts",children:[],level:3}],level:2}],m={toc:p};function u(e){var t=e.components,n=(0,a.Z)(e,i);return(0,r.kt)("wrapper",(0,o.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"hello-contract-truffle--remote-node"},"Hello Contract ","(","Truffle + Remote Node",")"),(0,r.kt)("p",null,"How to deploy and interact your own smart contracts using a remote node."),(0,r.kt)("hr",null),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"As Celo is fully EVM compatible, we inherit the rich developer ecosystem and tooling of the Ethereum community. You will be deploying a typical hello world smart contract onto the Alfajores testnet with the common Ethereum tool, Truffle."))),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"This page is similar to the Hello Contracts page, but this one will connect to a remote node (Forno) and do key management in the Truffle project."))),(0,r.kt)("h2",{id:"setup"},"Setup"),(0,r.kt)("p",null,"This guide assumes that you have a basic Node/",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/get-npm"},"NPM")," setup. "),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},(0,r.kt)("a",{parentName:"p",href:"https://www.trufflesuite.com/docs/truffle/overview"},"Learn more about the Truffle development framework here.")))),(0,r.kt)("p",null,"As you may know, Truffle is built for Ethereum developers. Because Celo has a similar network architecture and runs the Ethereum Virtual Machine, Celo developers are able to leverage many Ethereum developer tools. But it is important to keep in mind the differences. If you haven't already, please review the Celo overview."),(0,r.kt)(l.Z,{url:"/overview",pageName:"Celo Overview",mdxType:"PageRef"}),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/critesjosh/hello_contract-truffle"},"Clone this Truffle project from GitHub to get started"),". "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"git clone https://github.com/critesjosh/hello_contract-truffle.git\n")),(0,r.kt)("p",null,"This is a basic truffle project, with some additional files to help us with account management and deploying to a remote Celo test net node. Run ",(0,r.kt)("inlineCode",{parentName:"p"},"npm install")," to install of the project dependencies."),(0,r.kt)("h2",{id:"hello-world"},"Hello World!"),(0,r.kt)("p",null,"Add a contract with the command"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"truffle create contract HelloWorld\n")),(0,r.kt)("p",null,"We will not go into the details of how to write Solidity in this exercise, but you can learn more at the ",(0,r.kt)("a",{parentName:"p",href:"https://solidity.readthedocs.io/en/latest/"},"Solidity documentation page"),"."),(0,r.kt)("p",null,"The contract will just store a name for now:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-solidity",metastring:'title="contracts/HelloWorld.sol"',title:'"contracts/HelloWorld.sol"'},"\npragma solidity >=0.5.0 <0.8.0;\n\ncontract HelloWorld {\n  string name = 'Celo';\n\n  function getName() public view returns (string memory) {\n    return name;\n  }\n\n  function setName(string calldata newName) external {\n    name = newName;\n  }\n}\n")),(0,r.kt)("h2",{id:"prepare-deployment"},"Prepare Deployment"),(0,r.kt)("h3",{id:"compile-the-contract"},"Compile the contract"),(0,r.kt)("p",null,"Before you deploy the contract, you need to compile the Solidity code into Ethereum bytecode. The following truffle command will look in the ",(0,r.kt)("inlineCode",{parentName:"p"},"./contracts")," directory and compile any new or updated Solidity (",(0,r.kt)("inlineCode",{parentName:"p"},".sol"),") contracts."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"truffle compile\n")),(0,r.kt)("p",null,"After compiling the contract, you need to create a migration to deploy the contract. For that, create a file in the ",(0,r.kt)("inlineCode",{parentName:"p"},"./migrations/")," folder named ",(0,r.kt)("inlineCode",{parentName:"p"},"2_deploy_helloworld.js"),":"),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},(0,r.kt)("a",{parentName:"p",href:"https://www.trufflesuite.com/docs/truffle/getting-started/running-migrations"},"Learn more about Truffle migrations here.")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="migrations/2_deploy_helloworld.js"',title:'"migrations/2_deploy_helloworld.js"'},"var HelloWorld = artifacts.require('HelloWorld')\n\nmodule.exports = function (deployer) {\n  deployer.deploy(HelloWorld)\n}\n")),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"You can ",(0,r.kt)("a",{parentName:"p",href:"https://www.trufflesuite.com/docs/truffle/reference/configuration"},"learn more about Truffle configuration options here.")))),(0,r.kt)("h2",{id:"deploy-to-alfajores-remotely"},"Deploy to Alfajores ","(","Remotely",")"),(0,r.kt)("p",null,"When you deploy contracts to the Celo network with a remote node, you have to sign the contract deployment transaction locally before sending it to the remote node to be broadcast to the network. This presents some unique challenges when using Ethereum development tools ","(","like Truffle",")"," because Celo transaction objects are slightly different than Ethereum transaction objects."),(0,r.kt)("p",null,"When you are ready to deploy your contract to Alfajores, you'll need a Celo client connected to the testnet. In this exercise you will connect to a remote node to read and write to the public testnet (Alfajores), but you could also run a testnet node locally to perform the same actions."),(0,r.kt)("p",null,"Here are the steps to go through to deploy the contract to the Alfajores testnet."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Connect to Forno ","(","a remote Celo node service provider",")"),(0,r.kt)("li",{parentName:"ol"},"Get personal account information ","(","generate a private key if required, stored in ",(0,r.kt)("inlineCode",{parentName:"li"},"./.env"),")"),(0,r.kt)("li",{parentName:"ol"},"Get your personal account address and fund it via the ",(0,r.kt)("a",{parentName:"li",href:"https://celo.org/build/faucet"},"faucet")),(0,r.kt)("li",{parentName:"ol"},"Get the compiled contract bytecode"),(0,r.kt)("li",{parentName:"ol"},"Create and sign the contract deployment transaction"),(0,r.kt)("li",{parentName:"ol"},"Send transaction to the network")),(0,r.kt)("p",null,"Make sure the dependencies are installed with:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"yarn install\n")),(0,r.kt)("p",null,"Run the createAccount.js script with:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-text"},"node createAccount.js\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="createAccount.js"',title:'"createAccount.js"'},'const Web3 = require("web3")\nconst web3 = new Web3("http://localhost:8545")\n\nconsole.log(web3.eth.accounts.create())\n')),(0,r.kt)("p",null,"The provided code will print a private key / account pair in the terminal. Copy and paste the printed ",(0,r.kt)("inlineCode",{parentName:"p"},"priavteKey")," into a ",(0,r.kt)("inlineCode",{parentName:"p"},"PRIVATE_KEY")," variable in a file called ",(0,r.kt)("inlineCode",{parentName:"p"},".env"),", similar to what is shown in the ",(0,r.kt)("inlineCode",{parentName:"p"},".envexample")," file. The ",(0,r.kt)("inlineCode",{parentName:"p"},"address")," that is printed with the private key is the account that we will fund with the faucet."),(0,r.kt)("p",null,"If you go to the ",(0,r.kt)("a",{parentName:"p",href:"https://celo.org/build/faucet"},"Alfajores Faucet Page"),", you can faucet your account some CELO and see your balance increase."),(0,r.kt)("h3",{id:"deploy-the-contract"},"Deploy the contract"),(0,r.kt)("h4",{id:"truffle-deployment"},"Truffle Deployment"),(0,r.kt)("p",null,"Before you can use truffle for the migration, you need to set up the proper configuration in ",(0,r.kt)("inlineCode",{parentName:"p"},"./truffle-config.js"),".  At the top of ",(0,r.kt)("inlineCode",{parentName:"p"},"./truffle-config.js"),", set up the ",(0,r.kt)("inlineCode",{parentName:"p"},"kit")," by connecting to the test network and adding the account you just funded."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="truffle.config.js"',title:'"truffle.config.js"'},"const ContractKit = require('@celo/contractkit')\nconst Web3 = require('web3')\nrequire('dotenv').config()\n\nconst web3 = new Web3('https://alfajores-forno.celo-testnet.org')\nconst kit = ContractKit.newKitFromWeb3(web3)\n\nkit.connection.addAccount(process.env.PRIVATE_KEY)\n")),(0,r.kt)("p",null,"Then, in the ",(0,r.kt)("inlineCode",{parentName:"p"},"networks")," object, you can add the initialized ",(0,r.kt)("inlineCode",{parentName:"p"},"kit"),"provider to an ",(0,r.kt)("inlineCode",{parentName:"p"},"alfajores")," property."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="truffle.config.js"',title:'"truffle.config.js"'},'  networks: {\n    test: {\n      host: "127.0.0.1",\n      port: 7545,\n      network_id: "*"\n    },\n    alfajores: {\n      provider: kit.connection.web3.currentProvider, // CeloProvider\n      network_id: 44787,                             // Alfajores network id\n      gas: 4000000,            // You need to include the gas limit           \n    }\n  }\n')),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Truffle doesn't estimate the gas properly, so you need to specify a gas limit in ",(0,r.kt)("inlineCode",{parentName:"p"},"truffle.config.js"),"."))),(0,r.kt)("p",null,"Now, deploy the contracts to Alfajores with this command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"truffle migrate --network alfajores\n")),(0,r.kt)("h4",{id:"custom-nodejs-deployment"},"Custom Node.js Deployment"),(0,r.kt)("p",null,"In this section, you will deploy a contract using a simple Node.js script to show how you can do it without using Truffle."),(0,r.kt)("p",null,"You need to compile the ",(0,r.kt)("inlineCode",{parentName:"p"},"HelloWorld.sol")," contract using ","(","if it isn't already",")",":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"truffle compile\n")),(0,r.kt)("p",null,"This command will generate a ",(0,r.kt)("inlineCode",{parentName:"p"},"HelloWorld.json")," file in the ",(0,r.kt)("inlineCode",{parentName:"p"},"./build/contracts/")," directory. ",(0,r.kt)("inlineCode",{parentName:"p"},"HelloWorld.json")," contains a lot of data about the contract, compiler and low level details. Import this file into the deployment script ",(0,r.kt)("inlineCode",{parentName:"p"},"celo_deploy.js")," with:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},"const HelloWorld = require('./build/contracts/HelloWorld.json')\n")),(0,r.kt)("p",null,"You are finally ready to deploy the contract. Use the ",(0,r.kt)("inlineCode",{parentName:"p"},"kit"),"to create a custom transaction that includes the contract bytecode."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="celo_deploy.js"',title:'"celo_deploy.js"'},"let tx = await kit.connection.sendTransaction({\n    from: address,\n    data: HelloWorld.bytecode // from ./build/contracts/HelloWorld.json\n})\n")),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"To deploy a contract on Celo, use the ",(0,r.kt)("inlineCode",{parentName:"p"},"kit.connection.sendTransaction()")," function with no ",(0,r.kt)("inlineCode",{parentName:"p"},"to:")," field and the contract bytecode in the ",(0,r.kt)("inlineCode",{parentName:"p"},"data")," field. The account that you are sending the transaction from must have enough CELO to pay the transaction fee, unless you specify another currency as the ",(0,r.kt)("inlineCode",{parentName:"p"},"feeCurrency"),", then you need enough of that currency to pay the transaction fee."))),(0,r.kt)("p",null,"The entire deployment script is about 20 lines of code."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="celo_deploy.js"',title:'"celo_deploy.js"'},"const Web3 = require('web3')\nconst ContractKit = require('@celo/contractkit')\nconst web3 = new Web3('https://alfajores-forno.celo-testnet.org')\nconst privateKeyToAddress = require('@celo/utils/lib/address').privateKeyToAddress\nconst kit = ContractKit.newKitFromWeb3(web3)\nrequire('dotenv').config()\nconst HelloWorld = require('./build/contracts/HelloWorld.json')\n\nasync function awaitWrapper(){    \n    kit.connection.addAccount(process.env.PRIVATE_KEY) // this account must have a CELO balance to pay transaction fees\n\n    // This account must have a CELO balance to pay tx fees \n    // get some testnet funds at https://celo.org/build/faucet\n    const address = privateKeyToAddress(process.env.PRIVATE_KEY)\n    console.log(address)\n\n    let tx = await kit.connection.sendTransaction({\n        from: address,\n        data: HelloWorld.bytecode\n    })\n\n    const receipt = await tx.waitReceipt()\n    console.log(receipt)\n}\n\nawaitWrapper()\n")),(0,r.kt)("p",null,"Congratulations! You have deployed your first contract onto Celo! You can verify your contract deployment on ",(0,r.kt)("a",{parentName:"p",href:"https://alfajores-blockscout.celo-testnet.org/"},"Blockscout"),". You can get the transaction hash from the receipt and look it up on the block explorer. "),(0,r.kt)("h3",{id:"interacting-with-custom-contracts"},"Interacting with Custom Contracts"),(0,r.kt)("p",null,"Now HelloWorld.sol is deployed onto the Alfajores testnet. How can you interact with the deployed contract using ContractKit? ",(0,r.kt)("inlineCode",{parentName:"p"},"helloWorld.js")," includes some example code that shows how you can do this."),(0,r.kt)("p",null,"There are 3 functions defined in ",(0,r.kt)("inlineCode",{parentName:"p"},"helloWorld.js")," that accomplish this. "),(0,r.kt)("p",null,"The first function, ",(0,r.kt)("inlineCode",{parentName:"p"},"initContract()"),", reads the deployed contract information from the Truffle artifact at ",(0,r.kt)("inlineCode",{parentName:"p"},"HelloWorld.json"),". With this information, you can create a new web3.js Contract instance:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="helloWorld.js"',title:'"helloWorld.js"'},'async function initContract(){\n    // Check the Celo network ID\n    const networkId = await web3.eth.net.getId()\n    \n    // Get the contract associated with the current network\n    const deployedNetwork = HelloWorld.networks[networkId]\n    \n    // Create a new contract instance with the HelloWorld contract info\n    let instance = new kit.web3.eth.Contract(\n        HelloWorld.abi,\n        deployedNetwork && deployedNetwork.address\n    )\n\n    getName(instance)\n    setName(instance, "hello world!")\n}\n')),(0,r.kt)("p",null,"After creating the contract instance, the ",(0,r.kt)("inlineCode",{parentName:"p"},"initContract()")," function calls ",(0,r.kt)("inlineCode",{parentName:"p"},"getName()")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"setName()"),". "),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"getName()")," function will call, return and print the ",(0,r.kt)("inlineCode",{parentName:"p"},"getName()")," function of the provided instance of the HelloWorld contract. "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="helloWorld.js"',title:'"helloWorld.js"'},"async function getName(instance){\n    let name = await instance.methods.getName().call()\n    console.log(name)\n}\n")),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"setName()")," function is a bit more involved. First, it gets the account key from the provided ",(0,r.kt)("inlineCode",{parentName:"p"},"./secret")," file, just like in ",(0,r.kt)("inlineCode",{parentName:"p"},"celo_deploy.js"),". Then it creates a ",(0,r.kt)("inlineCode",{parentName:"p"},"txObject")," that encodes a smart contract transaction call to ",(0,r.kt)("inlineCode",{parentName:"p"},"setName()")," with the provided ",(0,r.kt)("inlineCode",{parentName:"p"},"newName")," to the provided instance of the HelloWorld contract. Then the function sends the encoded transaction object to the network, waits for a reciept and prints it to the console. "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="helloWorld.js"',title:'"helloWorld.js"'},"async function setName(instance, newName){\n\n    // Add your account to ContractKit to sign transactions\n    // This account must have a CELO balance to pay tx fees, get some https://celo.org/build/faucet\n    kit.connection.addAccount(process.env.PRIVATE_KEY)\n    const address = privateKeyToAddress(process.env.PRIVATE_KEY)\n\n    // Encode the transaction to HelloWorld.sol according to the ABI\n    let txObject = await instance.methods.setName(newName)\n    \n    // Send the transaction\n    let tx = await kit.sendTransactionObject(txObject, { from: address })\n\n    let receipt = await tx.waitReceipt()\n    console.log(receipt)\n}\n")),(0,r.kt)("p",null,"The above method shows a more detail about how to create custom deployment transactions and scripts than the previous method."),(0,r.kt)("p",null,"As you can see, all the goodies from Ethereum apply to Celo, so virtually all tutorials and other content should be easily translatable to Celo."),(0,r.kt)("p",null,"Check out ",(0,r.kt)("a",{parentName:"p",href:"https://celo.org/build"},"https://celo.org/build")," for more resources!"))}u.isMDXComponent=!0}}]);