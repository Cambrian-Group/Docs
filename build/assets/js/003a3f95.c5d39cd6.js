"use strict";(self.webpackChunkcelo_docs=self.webpackChunkcelo_docs||[]).push([[4057],{3905:function(e,t,o){o.d(t,{Zo:function(){return d},kt:function(){return h}});var r=o(67294);function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function n(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?n(Object(o),!0).forEach((function(t){a(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function s(e,t){if(null==e)return{};var o,r,a=function(e,t){if(null==e)return{};var o,r,a={},n=Object.keys(e);for(r=0;r<n.length;r++)o=n[r],t.indexOf(o)>=0||(a[o]=e[o]);return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)o=n[r],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}var l=r.createContext({}),c=function(e){var t=r.useContext(l),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},d=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var o=e.components,a=e.mdxType,n=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),u=c(o),h=a,f=u["".concat(l,".").concat(h)]||u[h]||p[h]||n;return o?r.createElement(f,i(i({ref:t},d),{},{components:o})):r.createElement(f,i({ref:t},d))}));function h(e,t){var o=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var n=o.length,i=new Array(n);i[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var c=2;c<n;c++)i[c]=o[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,o)}u.displayName="MDXCreateElement"},88545:function(e,t,o){o.r(t),o.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return c},toc:function(){return d},default:function(){return u}});var r=o(83117),a=o(80102),n=(o(67294),o(3905)),i=["components"],s={title:"Celo Rewards for Validators and Validator Groups",description:"Overview of epoch rewards for Validators and Validator Groups.",slug:"/celo-codebase/protocol/proof-of-stake/epoch-rewards/validator-rewards"},l="Validator Rewards",c={unversionedId:"celo-codebase/protocol/proof-of-stake/validator-rewards",id:"celo-codebase/protocol/proof-of-stake/validator-rewards",title:"Celo Rewards for Validators and Validator Groups",description:"Overview of epoch rewards for Validators and Validator Groups.",source:"@site/docs/celo-codebase/protocol/proof-of-stake/validator-rewards.md",sourceDirName:"celo-codebase/protocol/proof-of-stake",slug:"/celo-codebase/protocol/proof-of-stake/epoch-rewards/validator-rewards",permalink:"/celo-codebase/protocol/proof-of-stake/epoch-rewards/validator-rewards",editUrl:"https://github.com/celo-org/docs/edit/main/docs/celo-codebase/protocol/proof-of-stake/validator-rewards.md",tags:[],version:"current",frontMatter:{title:"Celo Rewards for Validators and Validator Groups",description:"Overview of epoch rewards for Validators and Validator Groups.",slug:"/celo-codebase/protocol/proof-of-stake/epoch-rewards/validator-rewards"},sidebar:"docs",previous:{title:"Celo Epoch Rewards Overview",permalink:"/celo-codebase/protocol/proof-of-stake/epoch-rewards"},next:{title:"Celo Locked CELO Rewards",permalink:"/celo-codebase/protocol/proof-of-stake/epoch-rewards/locked-gold-rewards"}},d=[{value:"On-target Rewards",id:"on-target-rewards",children:[],level:2},{value:"Calculating Uptime Score",id:"calculating-uptime-score",children:[],level:2},{value:"Calculating Slashing Penalty",id:"calculating-slashing-penalty",children:[],level:2},{value:"Group Share",id:"group-share",children:[],level:2}],p={toc:d};function u(e){var t=e.components,o=(0,a.Z)(e,i);return(0,n.kt)("wrapper",(0,r.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"validator-rewards"},"Validator Rewards"),(0,n.kt)("p",null,"Overview of epoch rewards for Validators and Validator Groups."),(0,n.kt)("hr",null),(0,n.kt)("p",null,"The protocol aims to incentivize validator uptime performance and penalize past poor behavior in future rewards, while ensuring that payments are economically reasonable in size independent of fluctuations of the price of CELO."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Five factors affect validator and group rewards:")),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"The on-target reward amount for this epoch"),(0,n.kt)("li",{parentName:"ul"},"The protocol's ",(0,n.kt)("a",{parentName:"li",href:"/celo-codebase/protocol/proof-of-stake/epoch-rewards"},"overall spending vs target of epoch rewards")),(0,n.kt)("li",{parentName:"ul"},"The validator\u2019s \u2018uptime score\u2019"),(0,n.kt)("li",{parentName:"ul"},"The current value of the slashing penalty for the group of which it was a member at the last election"),(0,n.kt)("li",{parentName:"ul"},"The group share for the group of which it was a member at the last election")),(0,n.kt)("p",null,"Epoch rewards to validators and validator groups are denominated in Celo Dollars, since it is anticipated that most of their expenses will be incurred in fiat currencies, allowing organizations to understand their likely return regardless of volatility in the price of CELO. To enable this, the protocol mints new Celo Dollars that correspond to the epoch reward equivalent of CELO which are maintained on chain to preserve the collateralization ratio. Of course, the effect on the target schedule depends on the prevailing exchange rate."),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://storage.googleapis.com/celo-website/docs/validator-rewards.jpg",alt:null})),(0,n.kt)("h2",{id:"on-target-rewards"},"On-target Rewards"),(0,n.kt)("p",null,"The on-target validator reward is a constant value (as block rewards typically would be) and is intended to cover costs plus an attractive margin for amortized capital and operating expenses associated with a recommended set up that includes redundant hosts with hardware wallets in a secure co-lo facility, proxy nodes at cloud or edge hosting providers, as well as security audits. As with most parameters of the Celo protocol, it can be changed by governance proposal."),(0,n.kt)("p",null,"In the usual case where no validator in the group has been slashed recently, and the validator has signed almost every block in the epoch, then the validator receives the full amount of the on-target reward, less the fraction sent to the validator group based on the group share. Unlike in some other proof-of-stake schemes, epoch rewards to validators do not depend on the number of votes the validator\u2019s group has received."),(0,n.kt)("h2",{id:"calculating-uptime-score"},"Calculating Uptime Score"),(0,n.kt)("p",null,"The Celo protocol tracks an \u2018uptime score\u2019 for each validator. When a validator proposes a block, it also includes in the block body every signature that it has received from validators committing the previous block."),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://storage.googleapis.com/celo-website/docs/uptime-score.jpg",alt:null})),(0,n.kt)("p",null,"For a validator to be \u2018up\u2019 at a given block, it must have its signature included in at least one in the previous twelve blocks. This cannot be done during the first 11 blocks of the epoch. At each epoch, this counter is reset to 0. Because the proposer order is shuffled at each election, it is very hard for a malicious actor withholding an honest validator\u2019s signatures to affect this measure."),(0,n.kt)("p",null,"Then, a validator\u2019s uptime for the epoch is the proportion of blocks in the epoch for which it is \u2018up\u2019: ",(0,n.kt)("inlineCode",{parentName:"p"},"U = counter/ (epoch_size - 11)"),". Its epoch uptime score ",(0,n.kt)("inlineCode",{parentName:"p"},"S_ve = u ^ k"),", where ",(0,n.kt)("inlineCode",{parentName:"p"},"k")," is a governable constant. This means that downtime of less than around a minute does not count against the validator, but that longer periods begin to reduce the score rapidly."),(0,n.kt)("p",null,"The validator\u2019s overall uptime score is an exponential moving average of the uptime score from this and previous epochs. ",(0,n.kt)("inlineCode",{parentName:"p"},"S_{v} = min(S_ve, S_ve * x + S_{v-1} * (1 -x))")," where ",(0,n.kt)("inlineCode",{parentName:"p"},"0 < x < 1")," and is governable. Since ",(0,n.kt)("inlineCode",{parentName:"p"},"S_v")," starts out at zero, validators have a disincentive to change identities and an incentive to prioritize activities that improve long-term availability."),(0,n.kt)("h2",{id:"calculating-slashing-penalty"},"Calculating Slashing Penalty"),(0,n.kt)("p",null,"The protocol also tracks for each group a \u2018slashing penalty\u2019, initially equal to one but successively reduced on each occasion a validator in that group is slashed. The penalty returns to one 30 days after it was last reduced."),(0,n.kt)("p",null,"This factor is applied to all rewards to validators in that group, to the group itself, and to voters for the group."),(0,n.kt)("p",null,"The slashing penalty gives groups a further incentive to vet validators they accept as members, not only to avoid reducing their own future rewards from existing validators but to attract and retain the best validators."),(0,n.kt)("p",null,"Validators have an incentive to be elected through groups with a high value, so a recent slashing makes a group less attractive. Validators also have an incentive to select groups where they believe careful vetting processes are in place, because poor vetting of other validators in the group reduces their own expectation of future rewards."),(0,n.kt)("p",null,"When a validator is slashed, reduced rewards may lead other validators in the same group to consider equivalently \u2018safe\u2019 slots in other groups, if they are available. A validator disassociating from the group would cause the group\u2019s rewards to further decline. While that may cause churn in the set of groups through which validators are elected, it is unlikely that a validator would move to a group where they could not be elected (since in this case they would receive no rewards, as opposed to fewer rewards), hence making the votes by which they were previously elected unproductive."),(0,n.kt)("h2",{id:"group-share"},"Group Share"),(0,n.kt)("p",null,"Validator groups are compensated by taking a share of the rewards allocated to validators. Validator groups set a ",(0,n.kt)("strong",{parentName:"p"},"group share")," rate when they register, and can change that at any time. The protocol automatically deducts this share, sending that portion of the epoch rewards to the validator group of which they were a member at the time of the last election."),(0,n.kt)("p",null,"Since the sum of a validator\u2019s reward and its validator group\u2019s reward are the same regardless of the \u2018group share\u2019 that the group chooses, no side-channel collusion is possible to avoid deductions for downtime or previous slashing."))}u.isMDXComponent=!0}}]);