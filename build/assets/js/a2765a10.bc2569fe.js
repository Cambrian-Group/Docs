"use strict";(self.webpackChunkcelo_docs=self.webpackChunkcelo_docs||[]).push([[8461],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return u}});var o=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=o.createContext({}),l=function(e){var t=o.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=l(e.components);return o.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},h=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,c=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),h=l(n),u=r,w=h["".concat(c,".").concat(u)]||h[u]||p[u]||a;return n?o.createElement(w,i(i({ref:t},d),{},{components:n})):o.createElement(w,i({ref:t},d))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=h;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var l=2;l<a;l++)i[l]=n[l];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}h.displayName="MDXCreateElement"},80464:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return c},metadata:function(){return l},toc:function(){return d},default:function(){return h}});var o=n(83117),r=n(80102),a=(n(67294),n(3905)),i=["components"],s={title:"Celo's Escrow Contract",description:"Introduction to the Celo Escrow contract and how to use it to withdraw, revoke, and reclaim funds."},c="Escrow",l={unversionedId:"celo-codebase/protocol/transactions/escrow",id:"celo-codebase/protocol/transactions/escrow",title:"Celo's Escrow Contract",description:"Introduction to the Celo Escrow contract and how to use it to withdraw, revoke, and reclaim funds.",source:"@site/docs/celo-codebase/protocol/transactions/escrow.md",sourceDirName:"celo-codebase/protocol/transactions",slug:"/celo-codebase/protocol/transactions/escrow",permalink:"/celo-codebase/protocol/transactions/escrow",editUrl:"https://github.com/celo-org/docs/edit/main/docs/celo-codebase/protocol/transactions/escrow.md",tags:[],version:"current",frontMatter:{title:"Celo's Escrow Contract",description:"Introduction to the Celo Escrow contract and how to use it to withdraw, revoke, and reclaim funds."},sidebar:"docs",previous:{title:"Celo Gas Pricing",permalink:"/celo-codebase/protocol/transactions/gas-pricing"},next:{title:"Celo Encrypted Payment Comments",permalink:"/celo-codebase/protocol/transactions/tx-comment-encryption"}},d=[{value:"What is the Escrow Contract?",id:"what-is-the-escrow-contract",children:[],level:2},{value:"How it works",id:"how-it-works",children:[],level:2},{value:"Withdrawing",id:"withdrawing",children:[],level:2},{value:"Revoking &amp; Reclaiming",id:"revoking--reclaiming",children:[],level:2}],p={toc:d};function h(e){var t=e.components,n=(0,r.Z)(e,i);return(0,a.kt)("wrapper",(0,o.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"escrow"},"Escrow"),(0,a.kt)("p",null,"Introduction to the Celo Escrow contract and how to use it to withdraw, revoke, and reclaim funds."),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"what-is-the-escrow-contract"},"What is the Escrow Contract?"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"Escrow")," contract utilizes Celo\u2019s Lightweight identity feature to allow users to ",(0,a.kt)("em",{parentName:"p"},"send payments to other users who don\u2019t yet have a public/private key pair or an address"),". These payments are stored in this contract itself and can be either withdrawn by the intended recipient or reclaimed by the sender. This functionality supports ",(0,a.kt)("em",{parentName:"p"},"both")," versions of Celo\u2019s lightweight identity: identifier-based ","(","such as a phone number to address mapping",")"," and privacy-based. This gives applications that intend to use this contract some flexibility in deciding which version of identity they prefer to use."),(0,a.kt)("h2",{id:"how-it-works"},"How it works"),(0,a.kt)("p",null,"If Alice wants to send a payment to Bob, who doesn\u2019t yet have an associated address, she will send that payment to this ",(0,a.kt)("inlineCode",{parentName:"p"},"Escrow")," contract and will also create a temporary public/private key pair. The associated temporary address will be referred to as the ",(0,a.kt)("inlineCode",{parentName:"p"},"paymentId"),". Alice will then externally share the newly created temporary private key, also known as an ",(0,a.kt)("em",{parentName:"p"},"invitation"),", to Bob, who will later use it to claim the payment. This paymentId will now be stored in this contract and will be mapped to relevant details related to this specific payment such as: the value of the payment, an optional identifier of the intended recipient, an optional amount of ",(0,a.kt)("inlineCode",{parentName:"p"},"attestations")," the recipient must have before being able to withdraw the payment, an amount of time after which the payment will expire ","(","more on that in the \u201cwithdrawing\u201d section below",")",", which asset is being transferred in this payment, etc."),(0,a.kt)("h2",{id:"withdrawing"},"Withdrawing"),(0,a.kt)("p",null,"The recipient of an escrowed payment can choose to withdraw their payment assuming they have successfully created their own public/private key pair and now have an address. To prove their identity, the recipient must be able to prove ownership of the paymentId\u2019s private key, which should have been given to them by the original sender. If the sender set a minimum number of attestations required to withdraw the payment, that will also be checked in order to successfully withdraw. Following the same example as above, if Bob wants to withdraw the payment Alice sent him, he must sign a message with the private key given to him by Alice. The message will be the address of Bob\u2019s newly created account. Bob will then be able to withdraw his payment by providing the paymentId and the v, r, and s outputs of the generated ECDSA signature."),(0,a.kt)("h2",{id:"revoking--reclaiming"},"Revoking & Reclaiming"),(0,a.kt)("p",null,"Alice sends Bob an escrowed payment. Let\u2019s say Bob never withdraws it, or worse, the temporary private key he needs to withdraw the payment gets lost or sent to the wrong person. For this purpose, Celo\u2019s protocol also allows for senders to reclaim any unclaimed escrowed payment that they sent. After an escrowed payment has expired ","(","each payment has its own expiry length that is set by the sender upon creation",")",", the sender of the payment can revoke the payment and reclaim their funds with just the paymentId."))}h.isMDXComponent=!0}}]);