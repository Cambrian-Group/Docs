<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="LMAX Docs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="LMAX Docs Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="LMAX Docs" href="/opensearch.xml">
<script defer="defer" src="https://cdn.usefathom.com/script.js" spa="auto" site="AZMFWALB"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.6.0/web3.min.js" async></script><title data-react-helmet="true">Celo Smart Contracts Release Process | LMAX Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.lmax.pro/community/release-process/smart-contracts"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Celo Smart Contracts Release Process | LMAX Docs"><meta data-react-helmet="true" name="description" content="Details of the release process for updating smart contracts on the Celo platform."><meta data-react-helmet="true" property="og:description" content="Details of the release process for updating smart contracts on the Celo platform."><link data-react-helmet="true" rel="icon" href="/img/color-favicon.png"><link data-react-helmet="true" rel="canonical" href="https://docs.lmax.pro/community/release-process/smart-contracts"><link data-react-helmet="true" rel="alternate" href="https://docs.lmax.pro/community/release-process/smart-contracts" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.lmax.pro/es/community/release-process/smart-contracts" hreflang="es"><link data-react-helmet="true" rel="alternate" href="https://docs.lmax.pro/community/release-process/smart-contracts" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://55M4I38S60-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.a3e4fade.css">
<link rel="preload" href="/assets/js/runtime~main.a63907df.js" as="script">
<link rel="preload" href="/assets/js/main.df7de80d.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/color-logo.png" alt="LMAX Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/color-logo.png" alt="LMAX Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">LMAX  Docs</b></a><a class="navbar__item navbar__link" href="/validator-guide/overview">Legal</a><a class="navbar__item navbar__link" href="/community/contributing">Community</a></div><div class="navbar__items navbar__items--right"><a href="https://www.lmax.com/blog/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_EbrZ"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/community/release-process/smart-contracts" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li><li><a href="/es/community/release-process/smart-contracts" target="_self" rel="noopener noreferrer" class="dropdown__link">EspaÃ±ol</a></li></ul></div><div class="toggle_iYfV toggle_2i4l toggleChecked_a04y toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" checked="" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="searchBox_Utm0"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><main class="docMainContainer_r8cw docMainContainerEnhanced_SOUu"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Smart Contracts Release Process</h1></header><p>Details of the release process for updating smart contracts on the Celo platform.</p><hr><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>This release process is a work in progress. Many infrastructure components required to execute it are not in place, and the process itself is subject to change.</p></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="versioning">Versioning<a class="hash-link" href="#versioning" title="Direct link to heading">â€‹</a></h2><p>Each deployed Celo core smart contract is versioned independently, according to semantic versioning, as described at <a href="https://semver.org" target="_blank" rel="noopener noreferrer">semver.org</a>, with the following modifications:</p><ul><li>STORAGE version when you make incompatible storage layout changes</li><li>MAJOR version when you make incompatible ABI changes</li><li>MINOR version when you add functionality in a backwards compatible manner, and</li><li>PATCH version when you make backwards compatible bug fixes.</li></ul><p>Changes to core smart contracts are made via on-chain Governance, approximately four times a year. When a release is made, <strong>all</strong> smart contracts from the release branch that differ from the deployed smart contracts are released, and included in the <strong>same</strong> governance proposal. Each release is identified by a unique monotonically increasing version number <code>N</code>, with <code>1</code> being the first release.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="core-contracts">Core Contracts<a class="hash-link" href="#core-contracts" title="Direct link to heading">â€‹</a></h3><p>Every deployed Celo core contract has its current version number as a constant which is publicly accessible via the <code>getVersion()</code> function, which returns the storage, major, minor, and patch version. Version number is encoded in the Solidity source and updated as part of code changes.</p><p>Celo Core Contracts deployed to a live network without the <code>getVersion()</code> function, such as the original set of core contracts, are to be considered version <code>1.1.0.0</code>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="mixins-and-libraries">Mixins and libraries<a class="hash-link" href="#mixins-and-libraries" title="Direct link to heading">â€‹</a></h3><p>Mixin contracts and libraries are considered part of the contracts that consume them. When a mixin or library has changed, all contracts that consume them should be considered to have changed as well, and thus the contracts should have their version numbers incremented and should be re-deployed as part of the next smart contract release.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="initialize-data">Initialize Data<a class="hash-link" href="#initialize-data" title="Direct link to heading">â€‹</a></h3><p>Whenever Celo Core Contracts need to be re-initialized, their initialization arguments should be checked into version control under <code>packages/protocol/releaseData/initializationData/release${N}.json</code>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="release-management-in-gitgithub">Release management in Git/Github<a class="hash-link" href="#release-management-in-gitgithub" title="Direct link to heading">â€‹</a></h3><p>Github branches/tags and Github releases are used to coordinate past and ongoing releases. Ongoing smart contract development is done on the <code>master</code> branch (even after release branches are cut). Every smart contract release has a designated release branch, e.g. <code>release/core-contracts/${N}</code> in the celo-monorepo.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="when-a-new-release-branch-is-cut">When a new release branch is cut:<a class="hash-link" href="#when-a-new-release-branch-is-cut" title="Direct link to heading">â€‹</a></h4><ol><li>A new release branch is created <code>release/core-contracts/${N}</code> with the contracts to be audited.</li><li>The latest commit on the release branch is tagged with <code>core-contracts.v${N}.pre-audit</code>.</li><li>On Github, a pre-release Github release should be created pointing at the latest tag on the release branch.</li><li>On master branch, <code>.circleci/config.yml</code> should be edited so that the variable <code>RELEASE_TAG</code> points to the tag <code>celo-core-contracts-v${N}.pre-audit</code> so that all future changes to master are versioned against the new release.</li><li>Ongoing audit responses/fixes should continue to go into <code>release/celo-core-contracts/${N}</code>.</li></ol><h4 class="anchor anchorWithStickyNavbar_y2LR" id="after-a-completed-release-process">After a completed release process:<a class="hash-link" href="#after-a-completed-release-process" title="Direct link to heading">â€‹</a></h4><ol><li>The release branch should be merged into <code>master</code> with a merge commit (instead of the usual squash merge strategy).</li><li>On master branch, <code>.circleci/config.yml</code> should be edited so that the variable <code>RELEASE_TAG</code> points to the tag <code>core-contracts.v${N}</code></li></ol><h2 class="anchor anchorWithStickyNavbar_y2LR" id="release-process">Release Process<a class="hash-link" href="#release-process" title="Direct link to heading">â€‹</a></h2><p>There are several scripts provided (under <code>packages/protocol</code> in <a href="https://github.com/celo-org/celo-monorepo" target="_blank" rel="noopener noreferrer">celo-org/celo-monorepo</a> and via for use in the release process and with contract upgrade governance proposals to give participating stakeholders increased confidence.</p><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>For these to run, you may need to follow the <a href="https://github.com/celo-org/celo-monorepo/blob/master/SETUP.md" target="_blank" rel="noopener noreferrer">setup instructions</a>. These steps include installing Node and setting <code>nvm</code> to use the correct version of Node. Successful <code>yarn install</code> and <code>yarn build</code> in the protocol package signal a completed setup.</p></div></div><p>Using these tools, a contract release candidate can be built, deployed, and proposed for upgrade automatically on a specified network. Subsequently, stakeholders can verify the release candidate against a governance upgrade proposal&#x27;s contents on the network.</p><p>Typical script options:</p><ul><li>By default, the scripts expect a celo-blockchain RPC at port 8545 locally. With <code>-f</code> you can specify the scripts to use a hosted forno node</li><li>By default, scripts will output verbose logs under <code>/tmp/celo-${script-name}.log</code>. You can change the location of the log output with <code>-l file.log</code></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="view-the-tagged-releases-for-each-network">View the tagged releases for each network<a class="hash-link" href="#view-the-tagged-releases-for-each-network" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">yarn</span><span class="token plain"> view-tags</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="verify-the-previous-release-on-the-network">Verify the previous Release on the Network<a class="hash-link" href="#verify-the-previous-release-on-the-network" title="Direct link to heading">â€‹</a></h3><p><code>verify-deployed</code> is a script that allows you to assess whether the bytecode on the given network matches the source code of a particular commit. It will run through the Celo Core Contracts and verify that the contracts&#x27; bytecodes as specified in the <code>Registry</code> match. Here, we will want to sanity-check that our network is running the previous release&#x27;s audited commit.</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Run from `packages/protocol` in the celo-monorepo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">PREVIOUS_RELEASE</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;core-contracts.v</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${N-1}</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">NETWORK</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${&quot;baklava&quot;|&quot;alfajores&quot;|&quot;mainnet&quot;}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># A -f boolean flag can be provided to use a forno full node to connect to the provided network</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">yarn</span><span class="token plain"> verify-deployed -n </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$NETWORK</span><span class="token plain"> -b </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$PREVIOUS_RELEASE</span><span class="token plain"> -f</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>A <code>libraries.json</code> file is written to disk only necessary for <code>make-release</code> that describes linked library addresses.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="check-backward-compatibility">Check Backward Compatibility<a class="hash-link" href="#check-backward-compatibility" title="Direct link to heading">â€‹</a></h3><p>This script performs some automatic checks to ensure that the smart contract versions in source code have been set correctly with respect to the latest release. It is run as part of CI and helps ensure that backwards incompatibilities are not accidentally introduced by requiring that devs manually update version numbers whenever smart contract changes are made.</p><p>Specifically, it compiles the latest and candidate releases and compares smart contracts:</p><ol><li>Storage layout, to detect storage version changes</li><li>ABI, to detect major and minor version changes</li><li>Bytecode, to detect patch version changes</li></ol><p>Finally, it checks release candidate smart contract version numbers and requires that they have been updated appropriately since the latest release by following semantic versioning as defined in the <a href="#Versioning">Versioning section</a> above.</p><p>The following exceptions apply:</p><ul><li>If the STORAGE version has changed, does not perform backwards compatibility checks</li><li>If the MAJOR version has changed, checks storage layout compatibility but not ABI compatibility</li></ul><p>Critically, this ensures that proxied contracts do not experience storage
collisions between implementation versions. See <a href="https://docs.openzeppelin.com/upgrades-plugins/1.x/proxies#storage-collisions-between-implementation-versions" target="_blank" rel="noopener noreferrer">this
article</a>
by OpenZeppelin for a good overview of this problem and why it&#x27;s important to
check for it.</p><p>The script generates a detailed report on version changes in JSON format.</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">PREVIOUS_RELEASE</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;core-contracts.v</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${N-1}</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">RELEASE_CANDIDATE</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;core-contracts.v</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${N}</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">yarn</span><span class="token plain"> check-versions -a </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$PREVIOUS_RELEASE</span><span class="token plain"> -b </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$RELEASE_CANDIDATE</span><span class="token plain"> -r </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;report.json&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This should be used in tandem with <code>verify-deployed -b $PREVIOUS_RELEASE -n $NETWORK</code> to ensure the compatibility checks compare the release candidate to what is actually active on the network.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="deploy-the-release-candidate">Deploy the release candidate<a class="hash-link" href="#deploy-the-release-candidate" title="Direct link to heading">â€‹</a></h3><p>Use the following script to build and deploy a candidate release. This takes as input the corresponding backwards compatibility report and canonical library address mapping to deploy <strong>changed</strong> contracts to the specified network. (Use <code>-d</code> to dry-run the deploy).
STORAGE updates are adopted by deploying a new proxy/implementation pair. This script outputs a JSON contract upgrade governance proposal.</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">NETWORK</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${&quot;baklava&quot;|&quot;alfajores&quot;|&quot;mainnet&quot;}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">RELEASE_CANDIDATE</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;core-contracts.v</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${N}</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">yarn</span><span class="token plain"> make-release -b </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$RELEASE_CANDIDATE</span><span class="token plain"> -n </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$NETWORK</span><span class="token plain"> -r </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;report.json&quot;</span><span class="token plain"> -i </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;releaseData/initializationData/release</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${N}</span><span class="token string" style="color:rgb(255, 121, 198)">.json&quot;</span><span class="token plain"> -p </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;proposal.json&quot;</span><span class="token plain"> -l </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;libraries.json&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The proposal encodes STORAGE updates by repointing the Registry to the new proxy. Storage compatible upgrades are encoded by repointing the existing proxy&#x27;s implementation.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="submit-upgrade-proposal">Submit Upgrade Proposal<a class="hash-link" href="#submit-upgrade-proposal" title="Direct link to heading">â€‹</a></h3><p>Submit the autogenerated upgrade proposal to the Governance contract for review by voters, outputting a unique identifier.</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># resultant proposal ID should be communicated publicly</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">celocli governance:propose --deposit 100e18 --from </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$YOUR_ADDRESS</span><span class="token plain"> --jsonTransactions </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;proposal.json&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="fetch-upgrade-proposal">Fetch Upgrade Proposal<a class="hash-link" href="#fetch-upgrade-proposal" title="Direct link to heading">â€‹</a></h3><p>Fetch the upgrade proposal and output the JSON encoded proposal contents.</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Make sure you run at least celocli 0.0.60</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">celocli governance:show --proposalID </span><span class="token operator">&lt;</span><span class="token plain">proposalId</span><span class="token operator">&gt;</span><span class="token plain"> --jsonTransactions </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;upgrade_proposal.json&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="verify-proposed-release-candidate">Verify Proposed Release Candidate<a class="hash-link" href="#verify-proposed-release-candidate" title="Direct link to heading">â€‹</a></h3><p>This script serves the same purpose as <code>verify-deployed</code> but for a not-yet
accepted contract upgrade (in the form of the proposal.json you fetched in the step prior). It gives you the confidence that the branch specified in the <code>-b</code> flag in (same as <code>check-versions</code>) will be the resulting network state of the proposal if executed. It does so by going over all Celo Core Contracts and determining updates to the Registry pointers, proxy or implementation contracts and verifying their implied bytecode against the compiled source code.</p><p>Additionally, include <code>initialization_data.json</code> from the CGP if any of the contracts have to be initialized.</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">RELEASE_CANDIDATE</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;core-contracts.v</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${N}</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">NETWORK</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${&quot;baklava&quot;|&quot;alfajores&quot;|&quot;mainnet&quot;}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># A -f boolean flag can be provided to use a forno full node to connect to the provided network</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">yarn</span><span class="token plain"> verify-release -p </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;upgrade_proposal.json&quot;</span><span class="token plain"> -b </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$RELEASE_CANDIDATE</span><span class="token plain"> -n </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$NETWORK</span><span class="token plain"> -f -i initialization_data.json</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="verify-executed-release">Verify Executed Release<a class="hash-link" href="#verify-executed-release" title="Direct link to heading">â€‹</a></h3><p>After a release executes via Governance, you can use <code>verify-deployed</code> again to check that the resulting network state does indeed reflect the tagged release candidate:</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">RELEASE</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;core-contracts.v</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${N}</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">NETWORK</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${&quot;baklava&quot;|&quot;alfajores&quot;|&quot;mainnet&quot;}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">yarn</span><span class="token plain"> verify-deployed -n </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$NETWORK</span><span class="token plain"> -b </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$RELEASE</span><span class="token plain"> -f</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="testing">Testing<a class="hash-link" href="#testing" title="Direct link to heading">â€‹</a></h2><p>All releases should be evaluated according to the following tests.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="unit-tests">Unit tests<a class="hash-link" href="#unit-tests" title="Direct link to heading">â€‹</a></h3><p>All changes since the last release should be covered by unit tests. Unit test coverage should be enforced by automated checks run on every commit.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="manual-checklist">Manual Checklist<a class="hash-link" href="#manual-checklist" title="Direct link to heading">â€‹</a></h3><p>After a successful release execution on a testnet, the resulting network state should be spot-checked to ensure that no regressions have been caused by the release. Flows to test include:</p><ul><li>Do a cUSD and CELO transfer<div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">celocli transfer:dollars --from </span><span class="token operator">&lt;</span><span class="token plain">addr</span><span class="token operator">&gt;</span><span class="token plain"> --value </span><span class="token operator">&lt;</span><span class="token plain">number</span><span class="token operator">&gt;</span><span class="token plain"> --to </span><span class="token operator">&lt;</span><span class="token plain">addr</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">celocli transfer:celo --from </span><span class="token operator">&lt;</span><span class="token plain">addr</span><span class="token operator">&gt;</span><span class="token plain"> --value </span><span class="token operator">&lt;</span><span class="token plain">number</span><span class="token operator">&gt;</span><span class="token plain"> --to </span><span class="token operator">&lt;</span><span class="token plain">addr</span><span class="token operator">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li>Register a Celo account<div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">celocli account:register --from </span><span class="token operator">&lt;</span><span class="token plain">addr</span><span class="token operator">&gt;</span><span class="token plain"> --name </span><span class="token operator">&lt;</span><span class="token plain">test-name</span><span class="token operator">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li>Report an Oracle rate<div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">celocli oracle:report --from </span><span class="token operator">&lt;</span><span class="token plain">addr</span><span class="token operator">&gt;</span><span class="token plain"> --value </span><span class="token operator">&lt;</span><span class="token plain">num</span><span class="token operator">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li>Do a CP-DOTO exchange<div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">celocli exchange:celo --value </span><span class="token operator">&lt;</span><span class="token plain">number</span><span class="token operator">&gt;</span><span class="token plain"> --from </span><span class="token operator">&lt;</span><span class="token plain">addr</span><span class="token operator">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">celocli exchange:dollars --value </span><span class="token operator">&lt;</span><span class="token plain">number</span><span class="token operator">&gt;</span><span class="token plain"> --from </span><span class="token operator">&lt;</span><span class="token plain">addr</span><span class="token operator">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li>Complete a round of attestation</li><li>Redeem from Escrow</li><li>Register a Vaildator<div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">celocli validator:register --blsKey </span><span class="token operator">&lt;</span><span class="token plain">hexString</span><span class="token operator">&gt;</span><span class="token plain"> --blsSignature </span><span class="token operator">&lt;</span><span class="token plain">hexString</span><span class="token operator">&gt;</span><span class="token plain"> --ecdsaKey </span><span class="token operator">&lt;</span><span class="token plain">hexString</span><span class="token operator">&gt;</span><span class="token plain"> --from </span><span class="token operator">&lt;</span><span class="token plain">addr</span><span class="token operator">&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li>Vote for a Validator</li><li>Run a mock election<div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">celocli election:run</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li>Get a valildator slashed for downtime and ejected from the validator set</li><li>Propose a governance proposal and get it executed<div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">celocli governance:propose --jsonTransactions </span><span class="token operator">&lt;</span><span class="token plain">jsonFile</span><span class="token operator">&gt;</span><span class="token plain"> --deposit </span><span class="token operator">&lt;</span><span class="token plain">number</span><span class="token operator">&gt;</span><span class="token plain"> --from </span><span class="token operator">&lt;</span><span class="token plain">addr</span><span class="token operator">&gt;</span><span class="token plain"> --descriptionURL https://gist.github.com/yorhodes/46430eacb8ed2f73f7bf79bef9d58a33</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="automated-environment-tests">Automated environment tests<a class="hash-link" href="#automated-environment-tests" title="Direct link to heading">â€‹</a></h3><p>Stakeholders can use the <code>env-tests</code> package in <code>celo-monorepo</code> to run an automated test suite against the network</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="performance">Performance<a class="hash-link" href="#performance" title="Direct link to heading">â€‹</a></h3><p>A ceiling on the gas consumption for all common operations should be defined and enforced by automated checks run on every commit.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="backwards-compatibility">Backwards compatibility<a class="hash-link" href="#backwards-compatibility" title="Direct link to heading">â€‹</a></h3><p>Automated checks should ensure that any new commit to <code>master</code> does not introduce a breaking change to storage layout, ABI, or other common backwards compatibility issues unless the STORAGE or MAJOR version numbers are incremented.</p><p>Backwards compatibility tests will also be run before every release to confirm that no breaking changes exist between the pending release and deployed smart contracts.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="audits">Audits<a class="hash-link" href="#audits" title="Direct link to heading">â€‹</a></h3><p>All changes since the last release should be audited by a reputable third party auditor.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="emergency-patches">Emergency patches<a class="hash-link" href="#emergency-patches" title="Direct link to heading">â€‹</a></h3><p>If patches need to be applied before the next scheduled smart contract release, they should be cherry picked to a new release branch, branched from the latest deployed release branch.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="promotion-process">Promotion process<a class="hash-link" href="#promotion-process" title="Direct link to heading">â€‹</a></h2><p>Deploying a new contract release should occur with the following process. On-chain governance proposals should be submitted on Tuesdays for consistency and predictability.</p><table><tr><td>Date</td><td>Action</td></tr><tr><td>T</td><td><ol><li>Create a Github issue tracking all these checklist items as an audit log</li><li>Implement the<!-- --> <a href="#When-a-new-release-branch-is-cut">git management steps</a> <!-- -->for when a new release branch is cut.</li><li>Submit release branch to a reputable third party auditor for review.</li><li>Begin drafting release notes.</li></ol></td></tr><tr><td>T+1w</td><td><ol><li>Receive report from auditors.</li><li>Add audit summary to final draft of the release notes.</li><li>If all issues in the audit report have straightforward fixes:<ol><li> <!-- -->Submit a governance proposal draft using this format: https://github.com/celo-org/celo-proposals/blob/master/CGPs/template.md</li><li> <!-- -->Add any initialization data to the CGP that should be included as part of the proposal</li><li> <!-- -->Announce forthcoming smart contract release on: https://forum.celo.org/c/governance</li></ol></li><li>Commit audit fixes to the release branch</li><li>Submit audit fixes to auditors for review.</li><li>Tag the first release candidate commit according to the<!-- --> <a href="#During-the-release-proposal-stage">git release management instructions</a>.</li><li>Let the community know about the upcoming release proposal by posting details to the Governance category on https://forum.celo.org and cross post in the<!-- --> <a href="https://discord.com/channels/600834479145353243/704805825373274134" target="_blank" rel="noopener noreferrer">Discord <code>#governance</code> channel.</a>See the &#x27;Communication guidelines&#x27; section below for information on what your post should contain.</li></ol></td></tr><tr><td>T+2w</td><td><ol><li>On Tuesday: Run the<!-- --> <a href="#release-process">smart contract release script</a> <!-- -->in order to to deploy the contracts to Baklava as well as submit a governance proposal.<ul><li>Transition proposal through Baklava<!-- --> <a href="/celo-codebase/protocol/governance"> <!-- -->governance process.</a></li><li>Update your forum post with the Baklava <code>PROPOSAL_ID</code>, updated timings (if any changes), and notify the community in the Discord <code>#governance</code> channel.</li></ul></li></ol></td></tr><tr><td>T+3w</td><td><ol><li>Confirm all contracts working as intended on Baklava.</li><li>Run the<!-- --> <a href="#release-process">smart contract release script</a> <!-- -->in order to to deploy the contracts to Alfajores as well as submit a governance proposal.</li><li>Update your forum post with the Alfajores <code>PROPOSAL_ID</code>, updated timings (if any changes), and notify the community in the Discord <code>#governance</code> channel.</li></ol></td></tr><tr><td>T+4w</td><td><ol><li>Confirm all contracts working as intended on Alfajores.</li><li>Confirm audit is complete and make the release notes and forum post contain a link to it.</li><li>On Tuesday: Run the<!-- --> <a href="https://docs.celo.org/community/release-process/smart-contracts#build-process" target="_blank" rel="noopener noreferrer">smart contract release script</a> <!-- -->in order to to deploy the contracts to Mainnet as well as submit a governance proposal.</li><li>Update the corresponding governance proposal with the updated on-chain<!-- --> <code>PROPOSAL_ID</code> and mark CGP status as &quot;PROPOSED&quot;.</li><li>Update your forum post with the Mainnet <code>PROPOSAL_ID</code>, updated timings (if any changes), and notify the community in the Discord <code>#governance</code> channel.</li><li>At this point all stakeholders are encouraged to<!-- --> <a href="#verify-release-process">verify</a> the proposed contracts deployed match the contracts from the release branch.</li><li>Monitor the progress of the proposal through the<!-- --> <a href="/celo-codebase/protocol/governance">governance process.</a><ul><li>Currently the governance process should take approximately 1 week: 24 hours for the dequeue process, 24 hours for the approval process, and 5 days for the referendum process. After which, the proposal is either declined or is ready to be executed within 3 days.</li><li>For updated timeframes, use the celocli:<!-- --> <code>celocli network:parameters</code></li></ul></li></ol></td></tr><tr><td>T+5w</td><td><ol><li>If the proposal passed:<ol><li>Confirm all contracts working as intended on Mainnet.</li><li>Update your forum post with the Mainnet governance outcome (<code>Passed</code> or <code>Rejected</code>) and notify the community in the Discord <code>#governance</code> channel.</li><li>Change corresponding CGP status to EXCECUTED.</li><li>Merge the release branch into <code>master</code> with a merge commit</li></ol></li><li>If the proposal failed:<ol><li>Change corresponding CGP status to EXPIRED.</li></ol></li></ol></td></tr></table><p>If the contents of the release (i.e. source Git commit) change at any point after the release has been tagged in Git, the process should increment the release identifier, and process should start again from the beginning. If the changes are small or do not introduce new code (e.g. reverting a contract to a previous version) the audit step may be accelerated.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="communication-guidelines">Communication guidelines<a class="hash-link" href="#communication-guidelines" title="Direct link to heading">â€‹</a></h3><p>Communicating the upcoming governance proposal to the community is critical and may help getting it approved.</p><p>Each smart contract release governance proposal should be accompanied by a <a href="https://forum.celo.org/c/governance/" target="_blank" rel="noopener noreferrer">Governance category</a> forum post that contains the following information:</p><ul><li>Name of proposer (individual contributor or organization).</li><li>Background information.</li><li>Link to the release on Github.</li><li>Link to the audit report(s).</li><li>Anticipated timings for the Baklava and Alfajores testnets and Mainnet.</li></ul><p>It&#x27;s recommended to post as early as possible and at minimum one week before the anticipated Baklava testnet governance proposal date.</p><p>Make sure to keep the post up to date. All updates (excluding fixing typos) should be communicated to the community in the <a href="http://chat.celo.org/" target="_blank" rel="noopener noreferrer">Discord</a> <code>#governance</code> channel.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="emergency-patches-1">Emergency patches<a class="hash-link" href="#emergency-patches-1" title="Direct link to heading">â€‹</a></h3><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>Work in progress</p></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="vulnerability-disclosure">Vulnerability Disclosure<a class="hash-link" href="#vulnerability-disclosure" title="Direct link to heading">â€‹</a></h2><p>Vulnerabilities in smart contract releases should be disclosed according to the <a href="https://github.com/celo-org/celo-monorepo/blob/master/SECURITY.md" target="_blank" rel="noopener noreferrer">security policy</a>.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="dependencies">Dependencies<a class="hash-link" href="#dependencies" title="Direct link to heading">â€‹</a></h2><p>None</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="dependents">Dependents<a class="hash-link" href="#dependents" title="Direct link to heading">â€‹</a></h2><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>Work in progress</p></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#versioning" class="table-of-contents__link toc-highlight">Versioning</a><ul><li><a href="#core-contracts" class="table-of-contents__link toc-highlight">Core Contracts</a></li><li><a href="#mixins-and-libraries" class="table-of-contents__link toc-highlight">Mixins and libraries</a></li><li><a href="#initialize-data" class="table-of-contents__link toc-highlight">Initialize Data</a></li><li><a href="#release-management-in-gitgithub" class="table-of-contents__link toc-highlight">Release management in Git/Github</a></li></ul></li><li><a href="#release-process" class="table-of-contents__link toc-highlight">Release Process</a><ul><li><a href="#view-the-tagged-releases-for-each-network" class="table-of-contents__link toc-highlight">View the tagged releases for each network</a></li><li><a href="#verify-the-previous-release-on-the-network" class="table-of-contents__link toc-highlight">Verify the previous Release on the Network</a></li><li><a href="#check-backward-compatibility" class="table-of-contents__link toc-highlight">Check Backward Compatibility</a></li><li><a href="#deploy-the-release-candidate" class="table-of-contents__link toc-highlight">Deploy the release candidate</a></li><li><a href="#submit-upgrade-proposal" class="table-of-contents__link toc-highlight">Submit Upgrade Proposal</a></li><li><a href="#fetch-upgrade-proposal" class="table-of-contents__link toc-highlight">Fetch Upgrade Proposal</a></li><li><a href="#verify-proposed-release-candidate" class="table-of-contents__link toc-highlight">Verify Proposed Release Candidate</a></li><li><a href="#verify-executed-release" class="table-of-contents__link toc-highlight">Verify Executed Release</a></li></ul></li><li><a href="#testing" class="table-of-contents__link toc-highlight">Testing</a><ul><li><a href="#unit-tests" class="table-of-contents__link toc-highlight">Unit tests</a></li><li><a href="#manual-checklist" class="table-of-contents__link toc-highlight">Manual Checklist</a></li><li><a href="#automated-environment-tests" class="table-of-contents__link toc-highlight">Automated environment tests</a></li><li><a href="#performance" class="table-of-contents__link toc-highlight">Performance</a></li><li><a href="#backwards-compatibility" class="table-of-contents__link toc-highlight">Backwards compatibility</a></li><li><a href="#audits" class="table-of-contents__link toc-highlight">Audits</a></li><li><a href="#emergency-patches" class="table-of-contents__link toc-highlight">Emergency patches</a></li></ul></li><li><a href="#promotion-process" class="table-of-contents__link toc-highlight">Promotion process</a><ul><li><a href="#communication-guidelines" class="table-of-contents__link toc-highlight">Communication guidelines</a></li><li><a href="#emergency-patches-1" class="table-of-contents__link toc-highlight">Emergency patches</a></li></ul></li><li><a href="#vulnerability-disclosure" class="table-of-contents__link toc-highlight">Vulnerability Disclosure</a></li><li><a href="#dependencies" class="table-of-contents__link toc-highlight">Dependencies</a></li><li><a href="#dependents" class="table-of-contents__link toc-highlight">Dependents</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">About LMAX</div><ul class="footer__items"><li class="footer__item"><a href="https://www.lmax.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LMAX Group</a></li><li class="footer__item"><a href="https://www.lmax.com/exchange" target="_blank" rel="noopener noreferrer" class="footer__link-item">LMAX Exchange </a></li><li class="footer__item"><a href="https://www.lmaxdigital.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>LMAX Digital<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/community/contributing">Contributors</a></li><li class="footer__item"><a href="https://www.youtube.com/@LMAXGroup" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Youtobe<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://discord.gg/EhCjWb9A" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/LmaxAsset" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://t.me/joinchat/F8Tdpoi_71E2NTFl" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Reddit<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.facebook.com/dmcsingular" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Ecosystem</div><ul class="footer__items"><li class="footer__item"><a href="https://lmax.pro/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>LMAX Global<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.ethereum.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Ethereum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.binance.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Binance Chain<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://polygon.technology/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Polygon<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 LMAX Group, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.a63907df.js"></script>
<script src="/assets/js/main.df7de80d.js"></script>
</body>
</html>